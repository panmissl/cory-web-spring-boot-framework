package com.cory.model;

import com.cory.db.annotations.Field;
import com.cory.db.annotations.Model;
import com.cory.db.enums.CoryDbType;
import com.cory.enums.UserLevel;
import com.cory.enums.UserStatus;
import com.cory.enums.UserType;
import com.cory.validation.UpdateGroup;
import lombok.Data;

import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;
import java.util.List;

/**
 * generated by CodeGenerator on 2017/5/10.
 */
@Data
@Model(name = "用户", module = "base")
public class User extends BaseModel {

    @Field(label = "电话", type = CoryDbType.VARCHAR, len = 100, nullable = true)
    private String phone;

    @Field(label = "邮箱", type = CoryDbType.VARCHAR, len = 100, nullable = true)
    private String email;

    @NotEmpty
    @Field(label = "密码", type = CoryDbType.VARCHAR, desc = "(不会自动加密，请填写加密后的密码)[可以使用默认密码：123456，对应的加密密码为：__MTIzNDU2IUAwIyQxJV4yKigp__添加后再修改用户密码即可]")
    private String password;

    @Field(label = "第三方账号ID", type = CoryDbType.VARCHAR, len = 200, nullable = true, desc = "没有可以留空")
    private String thirdpartyId;

    @Field(label = "第三方账号类型", type = CoryDbType.VARCHAR, len = 100, nullable = true, desc = "没有可以留空")
    private String thirdpartyType;

    @NotNull
    @Field(label = "类型", type = CoryDbType.ENUM, len = 50)
    private UserType type;

    @Field(label = "状态", type = CoryDbType.ENUM, len = 50)
    private UserStatus status;

    @Field(label = "级别", type = CoryDbType.ENUM, len = 50)
    private UserLevel level;

    @Field(label = "额外信息", type = CoryDbType.VARCHAR, showable = false, len = 20480, nullable = true)
    private String extraInfo;

    private List<Role> roles;

    public String getLogonId() {
        if (UserType.QQ.equals(this.getType())
                || UserType.WEIBO.equals(this.getType())
                || UserType.WEIXIN.equals(this.getType())) {
            return thirdpartyId;
        }
        return phone;
    }

    public boolean isDisabled() {
        if (UserStatus.NORMAL.equals(this.getStatus())) {
            return false;
        } else {
            return true;
        }
    }
}
